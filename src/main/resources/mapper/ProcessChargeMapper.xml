<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.oceansoft.szga.smp.mapper.ProcessChargeMapper">

    <select id="queryRoadSafeTable" resultType="java.util.Map">
        SELECT a.yhbh, a.cjsj, a.sjly, a.yhddmc, b.mc, a.lczt, a.clzt, c.name, a.wcsj FROM ods."ods_rt_jj_v_tb_yhpc" a
        LEFT JOIN ods."ods_rt_dm_v_yhpc_lx" b ON a.yhlx = b.dm
        LEFT JOIN ods."ods_rt_psms_sec_org" c ON a.mjbm = c.id
        <where>
            <if test="questionQueryBean.keyWord != null and questionQueryBean.keyWord != ''">
                (a.sjly like concat('%',#{questionQueryBean.keyWord},'%') or a.yhddmc like concat('%',#{questionQueryBean.keyWord},'%') or b.mc like concat('%',#{questionQueryBean.keyWord},'%'))
            </if>
            <if test="questionQueryBean.reactionDept == '民警录入'">
                and a.lczt = 1
            </if>
            <if test="questionQueryBean.reactionDept == '中队审核'">
                and a.lczt IN (2,3,4,5)
            </if>
            <if test="questionQueryBean.reactionDept == '大队审核'">
                and a.lczt IN (6,7,8,9)
            </if>
            <if test="questionQueryBean.reactionDept == '业务部门审核'">
                and a.lczt IN (10,11,12,13)
            </if>
            <if test="questionQueryBean.reactionDept == '支队审核'">
                and a.lczt IN (14,15,16,17)
            </if>
        </where>
    </select>
    <select id="queryRoadSafePointById" resultType="java.util.Map">
        SELECT cjsj, lczt FROM ods."ods_rt_jj_v_tb_yhpc" WHERE yhbh = #{id}
    </select>
    <select id="queryQzfTable" resultType="java.util.Map">
        SELECT a.bh, a.gxsj, a.xxly, a.czwdz, a.yhxxms, a.zzzt, a.shzt, a.lzzt, a.ffzt, a.rlzt, a.zgzt, b.name, a.zzsj, a.yhdl FROM ods."ods_rt_czfw_yhxx" a
        LEFT JOIN ods.ods_rt_dict_sqxx b ON a.sqdm = b.url
        <where>
        <choose>
            <when test="type == 1">
                a.yhdl = '1'
            </when>
            <otherwise>
                a.yhdl != '1'
            </otherwise>
        </choose>
        <if test="questionQueryBean.keyWord != null and questionQueryBean.keyWord != ''">
            and (a.xxly like concat('%',#{questionQueryBean.keyWord},'%') or a.czwdz like concat('%',#{questionQueryBean.keyWord},'%') or a.yhxxms like concat('%',#{questionQueryBean.keyWord},'%'))
        </if>
        <if test="questionQueryBean.reactionDept == '上报' || questionQueryBean.reactionDept == '分发'">
            and a.lzzt IN ('0','1')
        </if>
        <if test="questionQueryBean.reactionDept == '审核'">
            and a.shzt IN ('2','3')
        </if>
        <if test="questionQueryBean.reactionDept == '分发'">
            and a.ffzt IN ('5')
        </if>
        <if test="questionQueryBean.reactionDept == '认领'">
            and a.rlzt IN ('1005')
        </if>
        <if test="questionQueryBean.reactionDept == '整改'">
            and a.zgzt IN ('1006')
        </if>
        </where>
    </select>
    <select id="queryQzfPoint" resultType="java.util.Map">
        SELECT gxsj, lzzt, shzt, ffzt, rlzt, zgzt, yhdl FROM ods."ods_rt_czfw_yhxx" WHERE bh = #{id}
    </select>
    <select id="queryImpTable" resultType="java.util.Map">
        SELECT a.rwzj, a.jcsj, a.jcd, a.dwmc, a.jclx, a.clzt, a.dwdz, a.jzsj FROM ods."ods_rt_zypt_jcrw_new_yhxx" a
        INNER JOIN ods.ods_rt_zypt_sydw_jbxx b ON a.glzj = b.dwzj
        <if test="type == 1">
        WHERE b.glbm like '%2%' AND b.yyzt = '01' AND b.jbspzt = '3'
        </if>
        <if test="type == 2">
            WHERE b.glbm like '%6%' AND b.yyzt = '01' AND b.zawxpspzt = '3' AND b.dwfl = '%14%'
        </if>
        <if test="questionQueryBean.keyWord != null and questionQueryBean.keyWord != ''">
            and (a.jcd like concat('%',#{questionQueryBean.keyWord},'%') or a.dwmc like concat('%',#{questionQueryBean.keyWord},'%'))
        </if>
    </select>
    <select id="queryImpPoint" resultType="java.util.Map">
        SELECT jcsj, jclx, clzt FROM ods.ods_rt_zypt_jcrw_new_yhxx WHERE rwzj = #{id}
    </select>
</mapper>