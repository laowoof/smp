<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.oceansoft.szga.smp.mapper.DeliveryLogisticsSafeMapper">

    <select id="queryDeliveryRank1" resultType="java.util.Map">
        SELECT a.xzqh as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT xzqh FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" GROUP BY xzqh) a
        LEFT JOIN
        (select xzqh, sum(zbsl) from rpt.RPT_AQJG_JDWL_LCJG_SYDW group by xzqh order by sum DESC) b
        on a.xzqh = b.xzqh order by sum DESC
    </select>
    <select id="queryDeliveryRank2" resultType="java.util.Map">
        SELECT a.xzqh as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT xzqh FROM rpt."rpt_aqjg_jdwl_lcjg_cyry" GROUP BY xzqh) a
        LEFT JOIN
        (SELECT xzqh, sum(zbsl) FROM rpt."rpt_aqjg_jdwl_lcjg_cyry" GROUP BY xzqh order by sum DESC) b
        on a.xzqh = b.xzqh order by sum DESC
    </select>
    <select id="queryDeliveryRank3" resultType="java.util.Map">
        SELECT a.ssfxjmc as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT ssfxjmc FROM rpt."rpt_aqjg_jdwl_dwjcxx" GROUP BY ssfxjmc) a
        LEFT JOIN
        (SELECT ssfxjmc, sum(sl) FROM rpt."rpt_aqjg_jdwl_dwjcxx" WHERE jcztdm = '1' GROUP BY ssfxjmc order by sum DESC) b
        on a.ssfxjmc = b.ssfxjmc order by sum DESC
    </select>
    <select id="queryDeliveryRank4" resultType="java.util.Map">
        SELECT a.ssfxjmc as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT ssfxjmc FROM rpt."rpt_aqjg_jdwl_dwjcxx" GROUP BY ssfxjmc) a
        LEFT JOIN
        (SELECT ssfxjmc, sum(sl) FROM rpt."rpt_aqjg_jdwl_dwjcxx" WHERE jcztdm = '2' GROUP BY ssfxjmc) b
        ON a.ssfxjmc = b.ssfxjmc order by sum DESC
    </select>
    <select id="queryDeliveryRank5" resultType="java.util.Map">
        SELECT a.fjmc as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT fjmc FROM rpt."rpt_aqjg_jdwl_yhmx" GROUP BY fjmc) a
        left join
        (SELECT fjmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" where jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0' GROUP BY fjmc) b
        ON a.fjmc = b.fjmc order by sum DESC
    </select>
    <select id="queryDeliveryRank6" resultType="java.util.Map">
        SELECT a.fjmc as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT fjmc FROM rpt."rpt_aqjg_jdwl_yhmx" GROUP BY fjmc) a
        LEFT JOIN
        (SELECT fjmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" WHERE ((jclx IN ('1','2','3') AND clzt = '1') OR (jclx = '4' AND clzt = '3') OR (jclx = '4' AND clzt = '5') OR (jclx = '4' AND clzt = '6')) and jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0' GROUP BY fjmc) b
        ON a.fjmc = b.fjmc order by sum DESC
    </select>
    <select id="queryDeliveryRank7" resultType="java.util.Map">
        SELECT a.fjmc as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT fjmc FROM rpt."rpt_aqjg_jdwl_yhmx" GROUP BY fjmc) a
        LEFT JOIN
        (SELECT fjmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" WHERE ((jclx IN ('1','2','3') AND clzt != '1') OR (jclx = '4' AND clzt != '3') OR (jclx = '4' AND clzt != '5') OR (jclx = '4' AND clzt != '6')) and jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0' GROUP BY fjmc) b
        ON a.fjmc = b.fjmc order by sum DESC
    </select>
    <select id="queryDeliveryRank8" resultType="java.util.Map">
        SELECT a.xzqh as name, COALESCE(b.sum, 0) sum
        FROM
        (SELECT xzqh FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" GROUP BY xzqh) a
        LEFT JOIN
        (SELECT xzqh, sum(zbsl) FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" WHERE zrsqd = '1' GROUP BY xzqh order by sum DESC) b
        on a.xzqh = b.xzqh order by sum DESC
    </select>
    <select id="queryDrillRank1" resultType="java.util.Map">
        select sspcsmc, sum(zbsl) from rpt.RPT_AQJG_JDWL_LCJG_SYDW WHERE xzqh = #{fjmc} group by sspcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank2" resultType="java.util.Map">
        SELECT sspcsmc, sum(zbsl) FROM rpt."rpt_aqjg_jdwl_lcjg_cyry" WHERE xzqh = #{fjmc} GROUP BY sspcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank3" resultType="java.util.Map">
        SELECT sspcsmc, sum(sl) FROM rpt."rpt_aqjg_jdwl_dwjcxx" WHERE jcztdm = '1' AND ssfxjmc = #{fjmc}  GROUP BY sspcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank4" resultType="java.util.Map">
        SELECT sspcsmc, sum(sl) FROM rpt."rpt_aqjg_jdwl_dwjcxx" WHERE jcztdm = '2' AND ssfxjmc = #{fjmc} GROUP BY sspcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank5" resultType="java.util.Map">
        SELECT pcsmc as sspcsmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" WHERE fjmc = #{fjmc} GROUP BY pcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank6" resultType="java.util.Map">
        SELECT pcsmc as sspcsmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" WHERE jclx = '4' AND clzt = '3' AND fjmc = #{fjmc} GROUP BY pcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank7" resultType="java.util.Map">
        SELECT pcsmc as sspcsmc, sum(yhsl) FROM rpt."rpt_aqjg_jdwl_yhmx" WHERE jclx != '4' AND clzt != '3' AND fjmc = #{fjmc} GROUP BY pcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryDrillRank8" resultType="java.util.Map">
        SELECT sspcsmc, sum(zbsl) FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" WHERE zrsqd = '1' AND xzqh = #{fjmc} GROUP BY sspcsmc ORDER BY sum DESC LIMIT 10
    </select>
    <select id="queryHiddenNumAnalysisFind" resultType="java.util.Map">

        SELECT jcxmc as name, sum(yhsl) as value FROM rpt."rpt_aqjg_jdwl_yhmx"
        WHERE jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0'
        GROUP BY jcxmc
    </select>
    <select id="queryHiddenNumAnalysisHandler" resultType="java.util.Map">
        SELECT jcxmc as name, sum(yhsl) as value FROM rpt."rpt_aqjg_jdwl_yhmx"
        WHERE jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0' AND ((jclx IN ('1','2','3') AND clzt = '1') OR (jclx = '4' AND clzt = '3') OR (jclx = '4' AND clzt = '5') OR (jclx = '4' AND clzt = '6'))
        GROUP BY jcxmc
    </select>
    <select id="queryHiddenCompanyLevelDw" resultType="java.util.Map">
        SELECT a.dwdjmc as name, b.value
				FROM
				(SELECT COALESCE(dwdjmc, '未评定') as dwdjmc FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" GROUP BY dwdjmc) a
				LEFT JOIN
				(SELECT COALESCE(dwdjmc, '未评定') as dwdjmc, sum(zbsl) as value FROM rpt."rpt_aqjg_jdwl_lcjg_sydw" GROUP BY dwdjmc) b
				ON a.dwdjmc = b.dwdjmc
    </select>
    <select id="queryHiddenCompanyLevelYh" resultType="java.util.Map">
        SELECT a.dwdj as value, b."count"
        FROM
        (SELECT COALESCE(dwdj, '未评定') as dwdj FROM rpt."rpt_aqjg_jdwl_yhmx" GROUP BY dwdj) a
        LEFT JOIN
        (SELECT COALESCE(dwdj, '未评定') as dwdj, sum(yhsl) as count FROM rpt."rpt_aqjg_jdwl_yhmx"
                WHERE jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0'
                GROUP BY dwdj) b
                        ON a.dwdj = b.dwdj
    </select>
    <select id="queryImpTop" resultType="java.util.Map">
        SELECT jcxmc as name, coalesce(sum(yhsl), 0) as value FROM rpt."rpt_aqjg_jdwl_yhmx"
        WHERE jcd = '寄递业末端网点检查表' AND xxz = '否' AND jcxlx != '0' AND jbdj IN ('1','2','3')
        GROUP BY jcxmc ORDER BY value desc LIMIT 5
    </select>
    <select id="queryAnalysisNum" resultType="java.util.Map">

    </select>
    <select id="queryNumTrend" resultType="java.util.Map">

    </select>
</mapper>